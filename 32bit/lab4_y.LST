Turbo Assembler	 Version 5.0	    09-15-25 10:35:36	    Page 1
lab4_y.asm



      1					 .386
      2	00000000			 .model	flat, stdcall
      3					 option	casemap	:none
      4
      5					 includelib import32.lib
      6
      7					 extern	MessageBoxA: PROC
      8					 extern	ExitProcess: PROC
      9					 extern	LoadLibraryA: PROC
     10					 extern	GetProcAddress:	PROC
     11					 extern	FreeLibrary: PROC
     12
     13	00000000			 .data
     14	00000000  48 65	6C 6C 6F 20 61+	     input_string  db 'Hello asm world',0
     15		  73 6D	20 77 6F 72 6C+
     16		  64 00
     17	00000010  0000001A		     k		   dd 26
     18	00000014  0100*(00)		     result_buffer db 256 dup(0)
     19	00000114  14*(00000000)		     words_buffer  dd 20 dup(0)
     20	00000164  0100*(00)		     temp_buffer   db 256 dup(0)
     21	00000264  52 65	73 75 6C 74 00	     caption	   db "Result",0
     22	0000026B  70 72	6F 67 2E 64 6C+	     dllName	   db "prog.dll",0
     23		  6C 00
     24	00000274  49 6E	73 42 6C 61 6E+	     funcName	   db "InsBlanks",0
     25		  6B 73	00
     26	0000027E  00000000		     hLib	   dd 0
     27	00000282  00000000		     pInsBlanks	   dd 0
     28
     29	00000286			 .code
     30	00000000			 main proc
     31					     ; Загрузка	DLL
     32	00000000  68 0000026Br		     push offset dllName
     33	00000005  E8 00000000e		     call LoadLibraryA
     34	0000000A  A3 0000027Er		     mov hLib, eax
     35	0000000F  85 C0			     test eax, eax
     36	00000011  74 5D	90 90 90 90	     jz	exit_program
     37
     38					     ; Получение адреса функции
     39	00000017  68 00000274r		     push offset funcName
     40	0000001C  50			     push eax
     41	0000001D  E8 00000000e		     call GetProcAddress
     42	00000022  A3 00000282r		     mov pInsBlanks, eax
     43	00000027  85 C0			     test eax, eax
     44	00000029  74 3A	90 90 90 90	     jz	unload_dll
     45
     46					     ; Вызов InsBlanks через указатель
     47	0000002F  68 00000164r		     push offset temp_buffer
     48	00000034  68 00000114r		     push offset words_buffer
     49	00000039  68 00000014r		     push offset result_buffer
     50	0000003E  FF 35	00000010r	     push k
     51	00000044  68 00000000r		     push offset input_string
     52	00000049  FF 15	00000282r	     call pInsBlanks
     53	0000004F  83 C4	14		     add esp, 20     ; чистим стек
     54
     55					     ; Вывод результата
     56	00000052  6A 00			     push 0
     57	00000054  68 00000264r		     push offset caption
Turbo Assembler	 Version 5.0	    09-15-25 10:35:36	    Page 2
lab4_y.asm



     58	00000059  68 00000014r		     push offset result_buffer
     59	0000005E  6A 00			     push 0
     60	00000060  E8 00000000e		     call MessageBoxA
     61
     62	00000065			 unload_dll:
     63					     ; Освобождение	библиотеки
     64	00000065  FF 35	0000027Er	     push hLib
     65	0000006B  E8 00000000e		     call FreeLibrary
     66
     67	00000070			 exit_program:
     68	00000070  6A 00			     push 0
     69	00000072  E8 00000000e		     call ExitProcess
     70	00000077			 main endp
     71
     72					 end main
Turbo Assembler	 Version 5.0	    09-15-25 10:35:36	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??date				  Text	 "09-15-25"
??filename			  Text	 "lab4_y  "
??time				  Text	 "10:35:36"
??version			  Number 0500
@32Bit				  Text	 1
@CodeSize			  Text	 0
@Cpu				  Text	 0F0FH
@DataSize			  Text	 0
@FileName			  Text	 lab4_y
@Interface			  Text	 003h
@Model				  Text	 1
@WordSize			  Text	 4
@code				  Text	 FLAT
@curseg				  Text	 _TEXT
@data				  Text	 FLAT
@stack				  Text	 FLAT
ExitProcess			  Near32 ----:---- Extern
FreeLibrary			  Near32 ----:---- Extern
GetProcAddress			  Near32 ----:---- Extern
LoadLibraryA			  Near32 ----:---- Extern
MessageBoxA			  Near32 ----:---- Extern
caption				  Byte	 FLAT:0264
dllName				  Byte	 FLAT:026B
exit_program			  Near32 FLAT:0070
funcName			  Byte	 FLAT:0274
hLib				  Dword	 FLAT:027E
input_string			  Byte	 FLAT:0000
k				  Dword	 FLAT:0010
main				  Near32 FLAT:0000
pInsBlanks			  Dword	 FLAT:0282
result_buffer			  Byte	 FLAT:0014
temp_buffer			  Byte	 FLAT:0164
unload_dll			  Near32 FLAT:0065
words_buffer			  Dword	 FLAT:0114

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  32  0286 Dword  Public  DATA
FLAT				  Group
_TEXT				  32  0077 Dword  Public  CODE
